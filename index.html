import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword } 
from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";
import { getDatabase, ref, push, onChildAdded } 
from "https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js";

// ðŸ”´ YAHAN APNA FIREBASE CONFIG DALO
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  databaseURL: "https://YOUR_PROJECT.firebaseio.com",
  projectId: "YOUR_PROJECT"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getDatabase(app);

// ðŸ”¹ global functions expose
window.login = function(){
  signInWithEmailAndPassword(auth, email.value, password.value)
  .then(startChat)
  .catch(alert);
}

window.register = function(){
  createUserWithEmailAndPassword(auth, email.value, password.value)
  .then(startChat)
  .catch(alert);
}

function startChat(){
  login.style.display="none";
  chat.style.display="block";

  const msgRef = ref(db, "messages");
  onChildAdded(msgRef, snap=>{
    messages.innerHTML += `<div>${snap.val().text}</div>`;
  });
}

window.sendMsg = function(){
  push(ref(db,"messages"), {
    text: msg.value
  });
  msg.value="";
}
